<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout Seguro - Noskill Sensi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* --- FONTES EMBUTIDAS E CSS COMPILADO --- */
        @font-face {
          font-family: 'Poppins'; font-style: normal; font-weight: 400;
          src: url(https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfecg.woff2) format('woff2');
          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
        @font-face {
          font-family: 'Poppins'; font-style: normal; font-weight: 600;
          src: url(https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLEj6V1Y.woff2) format('woff2');
          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
        @font-face {
          font-family: 'Teko'; font-style: normal; font-weight: 700;
          src: url(https://fonts.gstatic.com/s/teko/v20/GzcdAaz5fMNPEDd3wA.woff2) format('woff2');
          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
        :root {
            --primary-red: #E53935;
            --bg-dark-primary: #121212;
            --bg-dark-secondary: #1E1E1E;
            --text-primary: #FFFFFF;
            --text-secondary: #A0A0A0;
            --border-color: #3A3A3A;
        }
        *,:after,:before{box-sizing:border-box}
        body{margin:0;font-family:'Poppins',sans-serif;background-color:var(--bg-dark-primary);color:var(--text-primary);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
        .font-teko{font-family:'Teko',sans-serif}
        .container{width:100%;max-width:600px;margin-left:auto;margin-right:auto;padding:2rem 1.5rem}
        .card{background-color:var(--bg-dark-secondary);border:1px solid var(--border-color);border-radius:12px;padding:2rem}
        .step-indicator{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}
        .step-circle{width:40px;height:40px;border-radius:50%;background-color:var(--primary-red);color:white;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:1.25rem}
        .step-title{font-family:'Teko',sans-serif;font-size:2.5rem;line-height:1;text-transform:uppercase}
        .form-label{font-size:0.9rem;font-weight:600;color:var(--text-secondary);margin-bottom:0.5rem;display:block}
        .form-input{width:100%;background-color:#111;border:1px solid var(--border-color);color:var(--text-primary);padding:1rem;border-radius:8px;font-size:1rem}
        .form-input:focus{outline:none;border-color:var(--primary-red);box-shadow:0 0 0 3px rgba(229,57,53,0.4)}
        .cta-button{width:100%;background-color:var(--primary-red);color:white;padding:1rem;border-radius:8px;font-family:'Teko',sans-serif;font-size:1.75rem;font-weight:700;text-transform:uppercase;cursor:pointer;transition:background-color 0.2s ease}
        .cta-button:hover{background-color:#C62828}
        .testimonial-card{background-color:#242424;padding:1.5rem;border-radius:12px;border:1px solid var(--border-color)}
        .testimonial-header{display:flex;align-items:center;gap:1rem;margin-bottom:1rem}
        .testimonial-avatar{width:50px;height:50px;border-radius:50%}
        .testimonial-rating{color:#FFC700}
        .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:opacity 0.3s ease, visibility 0.3s ease}
        .modal-overlay.active{opacity:1;visibility:visible}
        .modal-content{background-color:var(--bg-dark-secondary);padding:2rem;border-radius:12px;border:1px solid var(--border-color);width:90%;max-width:400px;text-align:center;transform:scale(0.95);transition:transform 0.3s ease}
        .modal-overlay.active .modal-content{transform:scale(1)}
    </style>
</head>
<body>

    <div class="container">
        <header style="text-align: center; margin-bottom: 3rem;">
            <img src="https://i.imgur.com/OfdLSLU.png" alt="Logo Noskill.Sensi" style="width: 100px; height: auto; margin: auto;">
        </header>

        <main style="display: grid; gap: 2rem;">
            <section id="step-1">
                <div class="step-indicator">
                    <div class="step-circle">1</div>
                    <h2 class="step-title">Identificação</h2>
                </div>
                <div class="card">
                    <form id="checkout-form">
                        <label for="email" class="form-label">Seu melhor e-mail para receber o acesso:</label>
                        <input type="email" id="email" name="email" class="form-input" placeholder="voce@exemplo.com" required>
                    </form>
                </div>
            </section>
            
            <section id="step-2">
                <div class="step-indicator">
                    <div class="step-circle">2</div>
                    <h2 class="step-title">Pagamento</h2>
                </div>
                <div class="card" style="display: grid; gap: 1.5rem;">
                    <div>
                        <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 1rem;">
                            <span style="color: var(--text-secondary);">Plano Permanente:</span>
                            <span style="font-weight: 600; font-size: 1.25rem;">R$ 14,97</span>
                        </div>
                        <div style="border-top: 1px solid var(--border-color); padding-top: 1rem; display: flex; justify-content: space-between; align-items: baseline;">
                            <span style="font-weight: bold;">Total a pagar:</span>
                            <span style="font-weight: bold; font-size: 1.5rem; color: #1DB954;">R$ 14,97</span>
                        </div>
                    </div>
                    <div style="text-align: center; padding: 1rem; border-radius: 8px; background-color: #111; border: 1px solid var(--border-color);">
                        <i class="fa-brands fa-pix" style="font-size: 1.5rem; margin-right: 0.5rem;"></i>
                        <span style="font-weight: 600;">Pagamento seguro via PIX</span>
                    </div>
                    <button type="submit" form="checkout-form" id="submit-button" class="cta-button">
                        Ativar Modo Capudo!
                    </button>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-secondary); font-size: 0.8rem;">
                        <i class="fas fa-lock"></i>
                        <span>Ambiente 100% seguro</span>
                    </div>
                </div>
            </section>

            <section id="testimonials">
                <h2 class="font-teko" style="font-size: 2.5rem; text-align: center; margin-bottom: 2rem; text-transform: uppercase;">Aprovado por quem joga sério</h2>
                <div style="display: grid; gap: 1.5rem;">
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="https://i.ibb.co/JFbX4Rng/vini.png" alt="Avatar Vini" class="testimonial-avatar">
                            <div>
                                <p style="font-weight: 600;">Vini</p>
                                <div class="testimonial-rating">★★★★★</div>
                            </div>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">"Pensei que ia ser mó trampo pra instalar... Em 2 minutos eu já tava amassando na rank, bglh simples e direto"</p>
                    </div>
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="https://i.ibb.co/1fygsR5c/gabriel.png" alt="Avatar Gabrielxs" class="testimonial-avatar">
                            <div>
                                <p style="font-weight: 600;">Gabrielxs</p>
                                <div class="testimonial-rating">★★★★★</div>
                            </div>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">"...depois que instalei parece que tô xitado kkkk a mira não pina mais, só vermelho... podem comprar sem medo"</p>
                    </div>
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="https://i.ibb.co/7JjBMPZH/lipe2x.png" alt="Avatar Lipe2x" class="testimonial-avatar">
                            <div>
                                <p style="font-weight: 600;">Lipe2x</p>
                                <div class="testimonial-rating">★★★★★</div>
                            </div>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">"O mais foda é que o app tá sempre atualizado pra nova temporada. Comprei o vitalício e não me preocupo mais."</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div id="pix-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="font-teko" style="font-size: 2rem; text-transform: uppercase; margin-bottom: 1rem;">Pague com PIX para Ativar</h2>
            <img id="pix-qrcode" src="" alt="PIX QR Code" style="width: 250px; height: 250px; margin: 1rem auto; background-color: white; padding: 10px; border-radius: 8px;">
            <p style="font-size: 0.9rem; color: var(--text-secondary);">Escaneie o QR Code com seu app do banco.</p>
            <div style="margin-top: 1.5rem; color: #FFC700; font-weight: 600; font-size: 1rem;" class="animate-pulse">
                <i class="fas fa-spinner fa-spin"></i> Aguardando pagamento...
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const checkoutForm = document.getElementById('checkout-form');
            const submitButton = document.getElementById('submit-button');
            const pixModal = document.getElementById('pix-modal');
            const API_BASE_URL = 'https://noskill-servidor.onrender.com';

            checkoutForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                submitButton.textContent = 'GERANDO...';
                submitButton.disabled = true;

                const email = document.getElementById('email').value;
                const planDetails = { planName: 'Permanente' };

                try {
                    const response = await fetch(`${API_BASE_URL}/criar-cobranca-pix`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ planName: planDetails.planName, customerEmail: email })
                    });
                    const data = await response.json();
                    if (!response.ok) { throw new Error(data.error || 'Ocorreu um erro ao gerar o PIX.'); }
                    
                    document.getElementById('pix-qrcode').src = `data:image/png;base64,${data.qrcodeBase64}`;
                    pixModal.classList.add('active');

                } catch (error) {
                    alert(error.message);
                    submitButton.textContent = 'Ativar Modo Capudo!';
                    submitButton.disabled = false;
                }
            });

            // Permite fechar o modal clicando fora do conteúdo
            pixModal.addEventListener('click', (e) => {
                if (e.target === pixModal) {
                    pixModal.classList.remove('active');
                    submitButton.textContent = 'Ativar Modo Capudo!';
                    submitButton.disabled = false;
                }
            });
        });
    </script>
</body>
</html>